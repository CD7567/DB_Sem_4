# SQL-скрипты

## `ddl.sql`

Скрипт, определяющий основную схему базы данных.


## `dml.sql`

Скрипт заполнения базы данных.


## `queries.sql`

Примеры запросов без тестирования.

### `SELECT`

- Выбор соответствия клиента и его транзакций
- Выбор соответствия транзакции и ее позиций
- Подсчет количества предложений на товар
- Определить самую дорогую по начислению транзакцию-покупку
- Определить среднее количество начисляемых бонусов при покупках
- Определить количество транзакций, проведенных успешно

### `DELETE`

- Удалить товары, на которые нет предложений
- Удалить магазины, не сделавшие предложений

### `UPDATE`

- Повысились налоги, цены на товары дороже 50$ увеличиваются на 5%
- Изменился региональный код страны (+2) на (+3)


## `select_count_tables.sql`

`SELECT` для тестов на целостность заполнения таблиц.


## `selects.sql`

Тестируемые запросы.

### `GROUP BY` + `HAVING`

- Вывести все товары, продаваемые в Ашане

### `ORDER BY`

- Вывести клиентов по возрасту
- Выбор соответствия транзакции и ее позиций

### `<func> OVER PARTITION BY`

- Вывести среднюю цену товаров
- Соответствие транзакций с их позициями и суммарным числом позиций

### `<func> OVER ORDER BY`

- Отранжировать клиентов по количеству бонусов


## `views.sql`
Создание `VIEW` для базы данных (вынесены в отдельную схему `v`).

- `VIEW` клиентов с сокрытием персональных данных
- `VIEW` продаваемых товаров с их средней ценой
- `VIEW` истории кошелька
- `VIEW` успешных транзакций с информацией
- `VIEW` торговли магазинами
- `VIEW` надежности клиентов


## `select_views.sql`
`SELECT` для тестов `VIEW`.

## `triggers.sql`
Создание триггера для таблицы `cd.transactions` базы данных.

- `TRIGGER` отмены произведенной ранее транзакции.

## `select_triggers.sql`
`SELECT` для тестов `TRIGGER`.
