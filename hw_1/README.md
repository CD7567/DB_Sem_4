# ___Домашняя работа №1: Простые запросы___

## ___Контекст задач 1-4___

В схеме `public` имеется таблица с измерениями роста (в дюймах) и веса (в фунтах) из одного исследования в США.

```postgresql
CREATE TABLE IF NOT EXISTS hw(
    id INTEGER,
    height FLOAT4,
    weight FLOAT4
)
```

---

## ___Контекст задач 5-9___

В схеме `public` имеется таблица, в которой хранится сводная статистика по операциям и параметрам торгов криптовалютами в разрезе дней.

```postgresql
CREATE TABLE IF NOT EXISTS coins(
    dt VARCHAR(16),
    avg_price NUMERIC,
    tx_cnt NUMERIC,
    tx_vol NUMERIC,
    active_addr_cnt NUMERIC,
    symbol VARCHAR(8),
    full_nm VARCHAR(128),
    open_price NUMERIC,
    high_price NUMERIC,
    low_price NUMERIC,
    close_price NUMERIC,
    vol NUMERIC,
    market NUMERIC
)
```

Описание значений, хранящихся в колонках:

 * `dt` — дата измерений
 * `avg_price` — средняя цена монеты за торговый день в USD
 * `tx_cnt` — количество транзакций в сети данной монеты
 * `tx_vol` — объем монет переведенных между адресами в сети данной монеты
 * `active_addr_cnt` — количество адресов совершавших а данный день транзации в сети данной монеты
 * `symbol` — сокращенное название монеты
 * `full_nm` — полное название монеты
 * `open_price` — цена монеты в начале торгов данного дня
 * `high_price` — самая высокая цена данной монеты в течение данного торгового дня
 * `low_price` — самая низкая цена данной монеты в течение данного торгового дня
 * `close_price` — цена монеты в конце торгов данного дня
 * `vol` — объем торгов данной монетой на биржах в данный день
 * `market` - капитализация данной монеты в данный день

---

## ___Контекст задачи 10___

Имеется база данных для недавно созданного загородного клуба. В ней имеется информация о членах этого клуба, объектов для 
отдыха, таких как теннисные корты, и истории бронирования. Помимо прочего, клуб хочет понять, как они могут использовать 
свою информацию для анализа использования/спроса на объекты. __Обратите внимание__: этот набор данных предназначен 
исключительно для интересного набора упражнений, а схема базы данных несовершенна в нескольких аспектах — пожалуйста, не
воспринимайте ее как пример хорошего дизайна.

В БД в схеме `cd` имееются 3 таблицы. Для этого задания нам потребуется только одна таблица `cd.facilities`.   

**Таблица `cd.facilities`**

```postgresql
CREATE TABLE cd.facilities(
   facid               INTEGER                NOT NULL, 
   name                CHARACTER VARYING(100) NOT NULL, 
   membercost          NUMERIC                NOT NULL, 
   guestcost           NUMERIC                NOT NULL, 
   initialoutlay       NUMERIC                NOT NULL, 
   monthlymaintenance  NUMERIC                NOT NULL
);
```

В таблице перечислены все доступные для бронирования объекты, которыми располагает загородный клуб. Клуб хранит 
информацию об идентификаторе/имени, стоимости бронирования как членов, так и гостей, первоначальную стоимость строительства объекта и предполагаемые ежемесячные расходы на содержание.

---

## ___Task 01___

Найдите значения наименьшего и наибольшего роста и веса.

### Ожидаемый формат ответа

Ваш запрос должен возвращать таблицу формата:

<div align="center">

| min_height | max_height | min_weight | max_weight |
|------------|------------|------------|------------|
| 23.02      | 63.12      | 98.01123   | 230.24     |

</div>

Числовые значения **не надо** конвертировать в метрическую систему.

---

## ___Task 02___

Посчитайте BMI (Body Mass Index — [link](https://www.cdc.gov/healthyweight/assessing/bmi/adult_bmi/index.html#:~:text=Body%20mass%20index%20(BMI)%20is,weight%2C%20overweight%2C%20and%20obesity.)) 
для каждого измерения.

### Ожидаемый формат ответа

Ваш запрос должен возвращать таблицу формата:

<div align="center">

| bmi     | 
|---------|
| 18.5    |
| 23.2637 |
| 33.042  |
| 21.901  |

</div>

---

## ___Task 03___

Найдите количество людей, с дефицитом массы тела (`BMI < 18,5`).

### Ожидаемый формат ответа

Ваш запрос должен возвращать таблицу формата:

<div align="center">

| underweight_count |
|-------------------|
| 1024              |

</div>

---

## ___Task 04___

Упорядочить людей по их `BMI` в убывающем порядке, а также указать тип комплекции согласно их `BMI`:
 * `BMI < 18,5` — `underweight`
 * `18,5 <= BMI < 25` — `normal`
 * `25 <= BMI < 30` — `overweight`
 * `30 <= BMI < 35` — `obese`
 * `35 <= BMI` — `extremely obese`

В случае равенства BMI упорядочивать по `id` также в порядке убывания.

### Ожидаемый формат ответа

Ваш запрос должен возвращать таблицу формата:

<div align="center">

| id  | bmi  | type   |
|-----|------|--------|
| 1   | 23.9 | normal |
| ... | .... | .......|

</div>

---

## ___Task 05___

Выбрать из таблицы все записи про биткоин ('BTC'), где его средняя цена за торговый день меньше 100 USD.

### Ожидаемый формат ответа

Совпадает со структурой исходной таблицы (выводятся все колонки таблицы).

---

## ___Task 06___

Выбрать из данных по крипотвалюте `DOGE` за 2018 год самую высокую цену и объем торгов за дни, когда её средняя цена была выше 0.1 цента.

### Ожидаемый формат ответа

Ваш запрос должен возвращать таблицу формата:

<div align="center">

| dt         | high_price | vol   |
|------------|------------|-------|
| 2022-02-02 | 23.02      | 63.12 |
| ...        | ...        | ...   |

</div>

---

## ___Task 07___

Вывести полные названия всех криптомонет в верхнем регистре без дубликатов. Результат должен быть отсортирован в лексикографическом порядке.

### Ожидаемый формат ответа

Ваш запрос должен возвращать таблицу формата:

<div align="center">

| full_name |
|-----------|
| BITCOIN   |
| ...       |

</div>

---

## ___Task 08___

Вывести для каждой криптомонеты день, когда значение цены было самым высоким. 
Упорядочить результат по цене в порядке убывания, а в случае равенства цен упорядочить по имени монеты. 
Если имеется несколько дней с таким значением, то выбираем самый ранний. 
Имя криптовалюты ожидается в верхнем регистре.

### Ожидаемый формат ответа

Ваш запрос должен возвращать таблицу формата:

<div align="center">

| full_name | dt         | price   |
|-----------|------------|---------|
| BITCOIN   | 2018-12-31 | 60000.0 |
| ...       | ...        | ...     |

</div>

---

## ___Task 09___

Удалить из таблицы записи, где не было транзакций или торгов.  

Прим.: использовать оператор `DELETE`.

### Ожидаемый формат ответа

Выводить ничего не надо.

---

## ___Task 10___

Выведите названия объектов и их ценовую категорию(объект получает ценовую категорию "expensive", если его ежемесячная стоимость обслуживания превышает 100 долларов, и "cheap" в ином случае).



### Ожидаемый формат ответа

Ваш запрос должен возвращать таблицу формата:

<div align="center">

| name             | cost      |
|------------------|-----------|
| Tennis Court 1   | expensive |
| Tennis Court 2   | expensive |
| Badminton Court  | cheap     |
| ...              | ...       |

</div>

---